name: Lint Check

on:
  pull_request:
    branches: [main, develop]

jobs:
  eslint:
    name: ESLint Check
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json

      - name: Install dependencies
        working-directory: ./frontend
        run: npm install

      - name: Run ESLint
        working-directory: ./frontend
        run: npm run lint
        continue-on-error: false

  lint-result:
    name: Lint Result Comment
    runs-on: ubuntu-latest
    needs: eslint
    if: failure()
    permissions:
      pull-requests: write

    steps:
      - name: Comment on PR (Lint Failed)
        uses: actions/github-script@v7
        with:
          script: |
            const body = `## âŒ ESLint ê²€ì‚¬ ì‹¤íŒ¨

            ì½”ë“œì— ì˜¤ë¥˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì–´ë¡œ í™•ì¸í•˜ì„¸ìš”:

            \`\`\`bash
            cd frontend
            npm run lint
            \`\`\`

            ìë™ ìˆ˜ì • ê°€ëŠ¥í•œ ì˜¤ë¥˜ëŠ” ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

            \`\`\`bash
            npm run lint:fix
            \`\`\`

            ---
            ğŸ¤– *ìë™ ìƒì„±ëœ ë©”ì‹œì§€ì…ë‹ˆë‹¤*`;

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              body: body
            });
